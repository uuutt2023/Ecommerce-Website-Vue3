{"version":3,"file":"js/492.b1636518.js","mappings":"2HAIAA,EAAQ,EAAU,CAACC,EAAKC,KACpB,MAAMC,EAASF,EAAIG,WAAaH,EAChC,IAAK,MAAOI,EAAKC,KAAQJ,EACrBC,EAAOE,GAAOC,EAElB,OAAOH,CAAM,C,ylBCKjB,MAAMI,EAAWA,IAAMC,EAAAA,EAAOC,O,4ZCR9B,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O,+kBCFA,MAAM,KAAEC,EAAI,IAAEC,EAAG,SAAEC,EAAQ,MAAEC,EAAK,MAAEC,GAAUC,EAuBxCC,GAAaC,EAAAA,EAAAA,IAAI,IACrBC,GAAYD,EAAAA,EAAAA,IAAI,MAChBE,GAAaF,EAAAA,EAAAA,KAAI,GACjBG,GAAUH,EAAAA,EAAAA,KAAI,GAEVI,EAAkCC,SACrCN,EAAWO,OAAQC,EAAAA,EAAAA,MAClBC,EAAAA,IACCC,IAAOC,EAAAA,EAAAA,YAAWD,EAAIb,KACtBa,IAAOE,EAAAA,EAAAA,SAAQ,IAAIZ,EAAWO,OAAQG,GAAKG,GAASA,EAAKC,MAHxCN,QAIXO,EAAAA,EAAMC,IAAIrB,IAAMsB,MAKrBC,GAAgBC,EAAAA,EAAAA,WAASb,WACxBc,EAAAA,EAAAA,SAAQzB,WAELU,IACNF,EAAWI,OAAQ,EACrB,GACC,KAKH,SAASc,IACHlB,EAAWI,QAAUH,EAAQG,QAC/BJ,EAAWI,OAAQ,EACnBP,EAAWO,MAAQ,GACnBW,IAEJ,CAEAlB,EAAWO,OAAOe,OAAS,GAAKJ,IAKhC,MAAMK,GAAgBtB,EAAAA,EAAAA,IAAI,MACxBuB,GAAgBvB,EAAAA,EAAAA,IAAI,MAEhBwB,EAAU,CACdC,KAAM,KACNC,WAAY,MACZC,UAAW,KAGbC,EAAAA,EAAAA,KAAS,KACP,IAAIC,sBACF,IAAM3B,EAAWI,QAAUH,EAAQG,OAASW,KAC5CO,GACAM,QAAQP,EAAcjB,OACxB,IAAIuB,qBAAqBT,EAAmBI,GAASM,QAAQR,EAAchB,MAAM,IAEnF,MAAMyB,GAAaC,EAAAA,EAAAA,KAAS,IAAsB,IAAhBvC,EAAK4B,QAAgBnB,GAAcH,EAAWO,MAAMe,OAAS,I,mxCC9E/F,MAAM7B,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,Q,qvBCCA,MAAMyC,GAAajC,EAAAA,EAAAA,MACbkC,GAAgBlC,EAAAA,EAAAA,IAAI,IAEpBmC,EAAW9B,UACf6B,EAAc5B,aAAeQ,EAAAA,EAAMC,IAAI,yBAAyBkB,EAAW3B,UAAUU,IAAI,EAGrFoB,GAAUpC,EAAAA,EAAAA,M,OAIhBqC,EAAAA,EAAAA,KAAmB,CAACC,EAAIC,EAAMC,KAC5BJ,EAAQ9B,OAAQmC,EAAAA,EAAAA,OAAMC,SAASC,cAAc,YAAYC,WACzDJ,GAAM,KAMRK,EAAAA,EAAAA,IAAY,KACVjB,EAAAA,EAAAA,MAAWkB,MAAK,IAAMJ,SAASC,cAAc,YAAYI,OAAO,EAAGX,EAAQ9B,W,gsBCvB7E,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://vue3-data-pulse/./node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.38_vue@3.4.38_webpack@5.94.0/node_modules/vue-loader/dist/exportHelper.js","webpack://vue3-data-pulse/./src/components/TopBar.vue","webpack://vue3-data-pulse/./src/components/TopBar.vue?4f82","webpack://vue3-data-pulse/./src/components/WaterFall.vue","webpack://vue3-data-pulse/./src/components/WaterFall.vue?2760","webpack://vue3-data-pulse/./src/views/user/components/UserHome.vue","webpack://vue3-data-pulse/./src/views/user/components/UserHome.vue?584f"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","<script setup>\r\nimport router from '@/router';\r\n\r\ndefineProps({\r\n  canBack: {\r\n    type: Boolean,\r\n    default: () => true,\r\n  },\r\n  title: {\r\n    type: String,\r\n    default: () => '',\r\n  },\r\n});\r\n\r\nconst jumpBack = () => router.back();\r\n</script>\r\n\r\n<template>\r\n  <div class=\"shadow-sm\">\r\n    <header class=\"row d-flex flex-column px-4\">\r\n      <div\r\n        id=\"bar\"\r\n        class=\"col-12\">\r\n        <div class=\"col-1 p-0\">\r\n          <i\r\n            v-if=\"canBack\"\r\n            class=\"iconfont icon-back\"\r\n            @click=\"jumpBack\" />\r\n        </div>\r\n        <div\r\n          id=\"topBar-title\"\r\n          class=\"col-auto p-0\">\r\n          <h5 class=\"m-0 text-center\">{{ title.length > 0 ? title : $route.meta?.title }}</h5>\r\n        </div>\r\n        <div class=\"col-auto p-0 d-inline-flex justify-content-end\">\r\n          <slot name=\"right\" />\r\n        </div>\r\n      </div>\r\n      <div\r\n        id=\"topBar-section\"\r\n        class=\"col-12 p-0\">\r\n        <slot name=\"section\" />\r\n      </div>\r\n    </header>\r\n    <hr class=\"mb-0 mt-1\" />\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n#bar {\r\n  height: 56px;\r\n  position: sticky;\r\n  top: 0;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\nheader {\r\n  flex-shrink: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n#topBar-section {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n#topBar-title {\r\n  position: absolute;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n}\r\n\r\n.iconfont {\r\n  font-size: 26px;\r\n}\r\n\r\n.shadow-sm {\r\n  z-index: 2;\r\n}\r\n</style>\r\n","import script from \"./TopBar.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./TopBar.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./TopBar.vue?vue&type=style&index=0&id=32ecd6f6&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.38_vue@3.4.38_webpack@5.94.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-32ecd6f6\"]])\n\nexport default __exports__","<script setup>\r\nimport { computed, nextTick, ref } from 'vue';\r\nimport { flow, isEmpty, sampleSize, throttle, unionBy } from 'lodash';\r\nimport { checkValueInterpolation, jumpToDetail, toggleFavorite } from '@/assets/js/util';\r\nimport axios from 'axios';\r\n\r\nconst { list, url, clickUrl, count, width } = defineProps({\r\n  width: {\r\n    type: String,\r\n    default: () => '',\r\n  },\r\n  url: {\r\n    type: String,\r\n    default: () => '',\r\n  },\r\n  clickUrl: {\r\n    type: String,\r\n    default: () => '',\r\n  },\r\n  count: {\r\n    type: Number,\r\n    default: () => 0,\r\n  },\r\n  list: {\r\n    type: Array,\r\n    default: () => [],\r\n  },\r\n});\r\n\r\nconst listRender = ref([]),\r\n  waterFall = ref(null),\r\n  canLoading = ref(false),\r\n  isTouch = ref(false);\r\n\r\nconst userSIlluminatedLoveRestoration = async () =>\r\n  (listRender.value = flow(\r\n    checkValueInterpolation,\r\n    (lt) => sampleSize(lt, count),\r\n    (lt) => unionBy([...listRender.value], lt, (item) => item.id),\r\n  )((await axios.get(url)).data));\r\n\r\n/**\r\n * 请求列表数据\r\n */\r\nconst getListImages = throttle(async () => {\r\n  if (!isEmpty(url)) {\r\n    // 用户已点亮的爱心恢复\r\n    await userSIlluminatedLoveRestoration();\r\n    canLoading.value = true;\r\n  }\r\n}, 600);\r\n\r\n/**\r\n * 下拉式添加推荐卡片\r\n */\r\nfunction refreshListImages() {\r\n  if (canLoading.value && !isTouch.value) {\r\n    canLoading.value = false;\r\n    listRender.value = [];\r\n    getListImages();\r\n  }\r\n}\r\n\r\nlistRender.value?.length > 0 || getListImages();\r\n\r\n/**\r\n * 加载图标出现在视窗时\r\n * */\r\nconst headerLoading = ref(null),\r\n  footerLoading = ref(null);\r\n\r\nconst options = {\r\n  root: null, // 使用默认的根元素为视口\r\n  rootMargin: '0px', // 根元素的边界偏移量\r\n  threshold: 0.5, // 元素可见度的阈值，这里设置为50%\r\n};\r\n\r\nnextTick(() => {\r\n  new IntersectionObserver(\r\n    () => canLoading.value && !isTouch.value && getListImages(),\r\n    options,\r\n  ).observe(footerLoading.value); // 底部加载图标出现时\r\n  new IntersectionObserver(refreshListImages, options).observe(headerLoading.value); // 顶部加载出现时全部重置\r\n});\r\nconst isLoadShow = computed(() => list.length === 0 && canLoading && listRender.value.length > 0);\r\n</script>\r\n\r\n<template>\r\n  <div\r\n    id=\"content\"\r\n    :class=\"{ 'extra-sliding-area': list.length === 0 }\"\r\n    class=\"container-fluid position-relative\"\r\n    @touchend=\"isTouch = false\"\r\n    @touchstart.passive=\"isTouch = true\">\r\n    <header\r\n      v-show=\"isLoadShow\"\r\n      class=\"position-absolute start-0 w-100 text-center\">\r\n      <i\r\n        ref=\"headerLoading\"\r\n        class=\"spinner-border\" />\r\n    </header>\r\n    <section\r\n      class=\"scroll\"\r\n      ref=\"waterFall\"\r\n      v-masonry\r\n      horizontal-order=\"true\"\r\n      item-selector=\".card\">\r\n      <div\r\n        v-for=\"item in list.length > 0 ? list : listRender\"\r\n        v-show=\"item.url\"\r\n        :key=\"item.id\"\r\n        v-masonry-tile\r\n        :style=\"{ width: width }\"\r\n        class=\"card my-3 mx-2\"\r\n        @click=\"jumpToDetail(clickUrl, item.id)\">\r\n        <div class=\"card-img-top\">\r\n          <img\r\n            :src=\"item.url\"\r\n            alt=\"catImg\"\r\n            class=\"img-thumbnail rounded-3\" />\r\n        </div>\r\n        <div class=\"card-body py-2\">\r\n          <p class=\"card-title m-0\">{{ item.title }}</p>\r\n          <i\r\n            :class=\"item.isActive ? 'icon-like-fill' : 'icon-like'\"\r\n            class=\"iconfont btn-like me-2\"\r\n            @click.stop=\"toggleFavorite(item)\" />\r\n        </div>\r\n      </div>\r\n    </section>\r\n    <!-- 上滑更新 -->\r\n    <footer\r\n      v-show=\"isLoadShow\"\r\n      class=\"position-absolute start-0 w-100\">\r\n      <i\r\n        ref=\"footerLoading\"\r\n        class=\"spinner-border\" />\r\n    </footer>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n@use '~@/assets/scss/utils';\r\n\r\n.card {\r\n  position: relative;\r\n\r\n  .img-thumbnail {\r\n    width: 100%;\r\n  }\r\n}\r\n\r\n.icon-like-fill {\r\n  color: #ff671c !important;\r\n}\r\n\r\n.container-fluid {\r\n  header {\r\n    top: 0;\r\n  }\r\n\r\n  header,\r\n  footer {\r\n    height: 10vh;\r\n    @extend %flex-center;\r\n  }\r\n}\r\n\r\n.extra-sliding-area {\r\n  section {\r\n    min-height: 80vh;\r\n  }\r\n\r\n  &:after,\r\n  &:before {\r\n    height: 10vh; /* 调整额外滑动区域的高度 */\r\n  }\r\n}\r\n\r\n.btn-like {\r\n  position: absolute;\r\n  right: 0;\r\n  bottom: 0;\r\n  color: #d0d0d0;\r\n  display: inline-block;\r\n}\r\n</style>\r\n","import script from \"./WaterFall.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./WaterFall.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./WaterFall.vue?vue&type=style&index=0&id=0932c094&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.38_vue@3.4.38_webpack@5.94.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0932c094\"]])\n\nexport default __exports__","<script setup>\r\nimport TopBar from '@/components/TopBar.vue';\r\nimport WaterFall from '@/components/WaterFall.vue';\r\nimport store from '@/store/store';\r\nimport { nextTick, onActivated, ref } from 'vue';\r\nimport axios from 'axios';\r\nimport { onBeforeRouteLeave } from 'vue-router';\r\nimport { floor } from 'lodash';\r\n\r\nconst searchTerm = ref();\r\nconst listRendering = ref([]);\r\n// eslint-disable-next-line no-unused-vars\r\nconst onSearch = async () => {\r\n  listRendering.value = (await axios.get(`/api/card/search?term=${searchTerm.value}`)).data;\r\n};\r\n\r\nconst scrollY = ref();\r\n/**\r\n * 记录当前滚动条位置\r\n * */\r\nonBeforeRouteLeave((to, from, next) => {\r\n  scrollY.value = floor(document.querySelector('#content').scrollTop);\r\n  next();\r\n});\r\n\r\n/**\r\n * 恢复滚动条位置\r\n * */\r\nonActivated(() =>\r\n  nextTick().then(() => document.querySelector('#content').scroll(0, scrollY.value)),\r\n);\r\n</script>\r\n\r\n<template>\r\n  <TopBar :can-back=\"false\">\r\n    <template #right>\r\n      <input\r\n        id=\"screen\"\r\n        aria-controls=\"collapseExample\"\r\n        aria-expanded=\"false\"\r\n        autocomplete=\"off\"\r\n        class=\"btn-check\"\r\n        data-bs-target=\"#collapseExample\"\r\n        data-bs-toggle=\"collapse\"\r\n        type=\"checkbox\" />\r\n      <label for=\"screen\">\r\n        <i class=\"iconfont icon-search ms-3\" />\r\n      </label>\r\n    </template>\r\n    <template #section>\r\n      <div class=\"row col-12 mb-1\">\r\n        <h1 class=\"m-0 col\">\r\n          伍零叁柒\r\n          <small>2.476 猫猫图o(=•ェ•=)m</small>\r\n        </h1>\r\n        <img\r\n          alt=\"logo\"\r\n          class=\"avatar rounded-circle\"\r\n          :src=\"store.getters.currentUserAvatar\" />\r\n      </div>\r\n      <div\r\n        id=\"collapseExample\"\r\n        class=\"collapse w-100 m-0\">\r\n        <form\r\n          class=\"input-group my-2\"\r\n          @submit.prevent=\"onSearch\">\r\n          <input\r\n            v-model=\"searchTerm\"\r\n            aria-describedby=\"button-addon1\"\r\n            class=\"form-control\"\r\n            name=\"searchValue\"\r\n            placeholder=\"猫咪名搜索\"\r\n            type=\"text\" />\r\n          <button\r\n            id=\"search\"\r\n            class=\"btn btn-outline-primary rounded-start-0\"\r\n            type=\"submit\">\r\n            搜索\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </template>\r\n  </TopBar>\r\n\r\n  <WaterFall\r\n    :list=\"listRendering\"\r\n    :click-url=\"'/user/home/detail'\"\r\n    :count=\"6\"\r\n    :url=\"'/api/card/list'\"\r\n    :width=\"'165px'\" />\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n.avatar {\r\n  width: 44px;\r\n  height: 44px;\r\n  padding: 0;\r\n}\r\n\r\nh1 {\r\n  display: inline-flex;\r\n  flex-direction: column;\r\n  color: rgb(45, 45, 47);\r\n  font-size: 24px;\r\n  font-weight: 700;\r\n  text-align: left;\r\n\r\n  small {\r\n    color: rgb(141, 141, 142);\r\n    font-size: 14px;\r\n    font-weight: 250;\r\n    line-height: 18px;\r\n    text-align: left;\r\n  }\r\n}\r\n</style>\r\n","import script from \"./UserHome.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./UserHome.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./UserHome.vue?vue&type=style&index=0&id=70aea1cc&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.38_vue@3.4.38_webpack@5.94.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-70aea1cc\"]])\n\nexport default __exports__"],"names":["exports","sfc","props","target","__vccOpts","key","val","jumpBack","router","back","__exports__","list","url","clickUrl","count","width","__props","listRender","ref","waterFall","canLoading","isTouch","userSIlluminatedLoveRestoration","async","value","flow","checkValueInterpolation","lt","sampleSize","unionBy","item","id","axios","get","data","getListImages","throttle","isEmpty","refreshListImages","length","headerLoading","footerLoading","options","root","rootMargin","threshold","nextTick","IntersectionObserver","observe","isLoadShow","computed","searchTerm","listRendering","onSearch","scrollY","onBeforeRouteLeave","to","from","next","floor","document","querySelector","scrollTop","onActivated","then","scroll"],"sourceRoot":""}